# Democracy - Comprehensive YAML (v2)
# Variables measuring democratic attitudes, perceptions, and satisfaction

missing_conventions:
  treat_as_na:
    codes: [-1, 0, 7, 8, 9, 97, 98, 99]
    description: "Standard missing codes"

variables:
  # ===========================================================================
  # GROUP 1: Democratic Satisfaction
  # ===========================================================================

  - id: dem_sat_national
    concept: democracy
    description: "Satisfaction with the way democracy works in the country"
    type: ordinal

    source:
      w1: q098
      w2: q93
      w3: q89
      w4: q92
      w5: q99
      w6: q90

    scale:
      min: 1
      max: 4
      labels:
        1: "Not at all satisfied"
        2: "Not very satisfied"
        3: "Fairly satisfied"
        4: "Very satisfied"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none
      exceptions:
        w1:
          method: r_function
          fn: safe_reverse_4pt
        w2:
          method: r_function
          fn: safe_reverse_4pt

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "democracy"

  # ===========================================================================
  # GROUP 2: Perceived Level of Democracy
  # ===========================================================================

  - id: dem_extent_current
    concept: democracy
    description: "In your opinion how much of a democracy is our country?"
    type: ordinal

    source:
      w1: null    # TODO: w1 asks different question (want to be democratic)
      w2: q94
      w3: q90
      w4: q93
      w5: q100
      w6: q91

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w2, w3, w4, w5, w6]
          phrase: "how much.*democracy"

  - id: dem_country_present_govt
    concept: democracy
    description: "Where would you place our country under the present government? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: q100
      w2: q96
      w3: q91
      w4: q94
      w5: q101
      w6: q92

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "place.*country|present.*government"

  # ===========================================================================
  # GROUP 3: Democratic Values / Support
  # ===========================================================================

  - id: dem_best_form
    concept: democracy
    description: "Democracy may have its problems, but it is still the best form of government"
    type: ordinal

    source:
      w1: null    # TODO: find w1 mapping
      w2: null    # TODO: find w2 mapping
      w3: q128
      w4: q129
      w5: q136
      w6: q128

    scale:
      min: 1
      max: 4
      labels:
        1: "Strongly disagree"
        2: "Somewhat disagree"
        3: "Somewhat agree"
        4: "Strongly agree"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w3, w4, w5, w6]
          phrase: "best form|democracy.*problem"

  - id: dem_suitable_country
    concept: democracy
    description: "Democracy is suitable for our country"
    type: ordinal

    source:
      w1: q103
      w2: q98
      w3: q94    # TODO: verify - may be 10pt scale
      w4: q97
      w5: q104
      w6: q95

    scale:
      min: 1
      max: 10
      labels:
        1: "Not suitable at all"
        10: "Completely suitable"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "democracy.*suitable"

  # ===========================================================================
  # GROUP 4: Democratic Rights / Freedoms
  # ===========================================================================

  - id: dem_free_speech
    concept: democracy
    description: "People are free to speak what they think without fear"
    type: ordinal

    source:
      w1: null    # TODO: find w1 mapping
      w2: q110
      w3: q106
      w4: q108
      w5: q115
      w6: q106

    scale:
      min: 1
      max: 4
      labels:
        1: "Strongly disagree"
        2: "Somewhat disagree"
        3: "Somewhat agree"
        4: "Strongly agree"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w2, w3, w4, w5, w6]
          phrase: "free to speak|speak.*fear"

  # ===========================================================================
  # GROUP 5: Government Satisfaction (related)
  # ===========================================================================

  - id: gov_sat_national
    concept: democracy
    description: "How satisfied or dissatisfied are you with the current president/government?"
    type: ordinal

    source:
      w1: q104
      w2: q99
      w3: q95
      w4: q98
      w5: q105
      w6: q96

    scale:
      min: 1
      max: 4
      labels:
        1: "Very dissatisfied"
        2: "Somewhat dissatisfied"
        3: "Somewhat satisfied"
        4: "Very satisfied"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "satisf.*president|satisf.*government"

  - id: dem_country_past
    concept: democracy
    description: "Where would you place our country ten years ago? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: q92
      w4: q95
      w5: q102
      w6: q93

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w3, w4, w5, w6]
          phrase: "ten years ago|years ago"

  - id: dem_country_future
    concept: democracy
    description: "Where would you expect our country to be ten years from now? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: q93
      w4: q96
      w5: q103
      w6: q94

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w3, w4, w5, w6]
          phrase: "ten years from now|future"

  - id: hh_income_sat
    concept: democracy
    description: "Satisfaction with household income"
    type: ordinal

    source:
      w1: se9a
      w2: se9a
      w3: se9a
      w4: se9a
      w5: se9a
      w6: SE14a

    scale:
      min: 1
      max: 4
      labels:
        1: "Very dissatisfied"
        2: "Fairly dissatisfied"
        3: "Fairly satisfied"
        4: "Very satisfied"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "income|satisfaction"

  # ===========================================================================
  # GROUP 6: Democracy Scale - Country Placement (Wave 1)
  # ===========================================================================

  - id: dem_country_authoritarian
    concept: democracy
    description: "Where would you place our country during the period of most recent authoritarian rule? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: q099
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - retrospective rating of authoritarian period"

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w1]
          phrase: "authoritarian|previous.*government"

  - id: dem_want_democratic
    concept: democracy
    description: "To what extent would you want our country to be democratic now? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: q101
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - desired level of democracy"

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w1]
          phrase: "want.*democratic|extent.*democratic"

  - id: dem_country_five_years
    concept: democracy
    description: "Where do you expect our country to be in five years? (1=dictatorship, 10=democracy)"
    type: ordinal

    source:
      w1: q102
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - 5-year expectation (cf. dem_country_future for 10-year)"

    scale:
      min: 1
      max: 10
      labels:
        1: "Complete dictatorship"
        10: "Complete democracy"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 10]
      validate:
        - waves: [w1]
          phrase: "five years|expect.*country"

  # ===========================================================================
  # GROUP 7: Regime Comparison - Is Better Than Before? (Wave 1)
  # Scale: 1-5 (Much worse to Much better)
  # ===========================================================================

  - id: regime_freespeech_better
    concept: democracy
    description: "Everyone is free to say what they think - is it better than before?"
    type: ordinal

    source:
      w1: q105
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - regime comparison battery"

    scale:
      min: 1
      max: 5
      labels:
        1: "Much worse"
        2: "Somewhat worse"
        3: "Much the same"
        4: "Somewhat better"
        5: "Much better than before"

    harmonize:
      default:
        method: identity
        note: "Higher = more improvement perceived"

    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1]
          phrase: "free.*say|better than before"

  - id: regime_influence_better
    concept: democracy
    description: "People like me can have an influence on government - is it better than before?"
    type: ordinal

    source:
      w1: q107
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - regime comparison battery"

    scale:
      min: 1
      max: 5
      labels:
        1: "Much worse"
        2: "Somewhat worse"
        3: "Much the same"
        4: "Somewhat better"
        5: "Much better than before"

    harmonize:
      default:
        method: identity
        note: "Higher = more improvement perceived"

    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1]
          phrase: "influence.*government|better than before"

  - id: regime_corruption_better
    concept: democracy
    description: "Corruption in politics and government is under control - is it better than before?"
    type: ordinal

    source:
      w1: q108
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - regime comparison battery"

    scale:
      min: 1
      max: 5
      labels:
        1: "Much worse"
        2: "Somewhat worse"
        3: "Much the same"
        4: "Somewhat better"
        5: "Much better than before"

    harmonize:
      default:
        method: identity
        note: "Higher = more improvement perceived"

    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1]
          phrase: "corruption.*control|better than before"

  - id: regime_inequality_better
    concept: democracy
    description: "The gap between the rich and the poor has narrowed - is it better than before?"
    type: ordinal

    source:
      w1: q109
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - regime comparison battery"

    scale:
      min: 1
      max: 5
      labels:
        1: "Much worse"
        2: "Somewhat worse"
        3: "Much the same"
        4: "Somewhat better"
        5: "Much better than before"

    harmonize:
      default:
        method: identity
        note: "Higher = more improvement perceived"

    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1]
          phrase: "rich.*poor|gap.*narrowed|better than before"

  - id: regime_judiciary_better
    concept: democracy
    description: "Judges and courts are free from political interference - is it better than before?"
    type: ordinal

    source:
      w1: q112
      w2: null
      w3: null
      w4: null
      w5: null
      w6: null
    note: "Wave 1 only - regime comparison battery"

    scale:
      min: 1
      max: 5
      labels:
        1: "Much worse"
        2: "Somewhat worse"
        3: "Much the same"
        4: "Somewhat better"
        5: "Much better than before"

    harmonize:
      default:
        method: identity
        note: "Higher = more improvement perceived"

    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1]
          phrase: "judges.*courts|political interference|better than before"
