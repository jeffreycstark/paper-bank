# Model Variable Specification (v2)
# This file serves as a reference example for the elegant YAML format
# Copy and adapt this structure for new variables

missing_conventions:
  treat_as_na:
    codes: [-1, -2, 97, 98, 99]
    description: "Standard missing codes across all waves"

variables:
  # ============================================================================
  # Example 1: Simple identity mapping (no transformations)
  # ============================================================================
  - id: econ_national_now
    concept: economy
    description: "Overall national economic condition today"
    type: ordinal
    
    source:
      w1: q001
      w2: q1
      w3: q1
      w4: q1
      w5: q1
      w6: q1
    
    scale:
      min: 1
      max: 5
      labels:
        1: "Very bad"
        2: "Bad"
        3: "So so"
        4: "Good"
        5: "Very good"
    
    harmonize:
      default:
        method: identity
    
    qc:
      valid_range: [1, 5]
      validate:
        - waves: [w1, w2, w3]
          phrase: "econom"
        - waves: [w4, w5, w6]
          phrase: "economy"
    
    tags: [core, "candidate_index:economy"]

  # ============================================================================
  # Example 2: With wave-specific transformations
  # ============================================================================
  - id: trust_civil_service
    concept: institutional_trust
    description: "Trust in civil service"
    type: ordinal
    
    source:
      w1: q011
      w2: q12
      w3: q12
      w4: q12
      w5: q12
      w6: q12
    
    scale:
      min: 1
      max: 4
      labels:
        1: "No trust"
        2: "Low trust"
        3: "High trust"
        4: "Complete trust"
    
    harmonize:
      default:
        method: identity
      # Only waves that differ from default
      exceptions:
        w3:
          method: r_function
          fn: safe_reverse_4pt
        w4:
          method: r_function
          fn: safe_reverse_4pt
    
    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w1, w2]
          phrase: "CIVIL"
        - waves: [w3, w4, w5, w6]
          phrase: "CIVIL"
    
    tags: [core, institutional_trust]

  # ============================================================================
  # Example 3: Continuous variable
  # ============================================================================
  - id: satisfaction_democracy_level
    concept: democracy_satisfaction
    description: "Satisfaction with how democracy works (0-10 scale)"
    type: continuous
    
    source:
      w1: q098
      w2: q93
      w3: q89
      w4: q92
      w5: q99
      w6: q90
    
    scale:
      min: 0
      max: 10
      labels:
        0: "Not at all satisfied"
        10: "Very satisfied"
    
    harmonize:
      default:
        method: identity
    
    qc:
      valid_range: [0, 10]
      validate:
        - waves: [w1, w2, w3, w4, w5, w6]
          phrase: "satisfy|democracy"
    
    tags: [core, "candidate_index:democracy"]

# ============================================================================
# Guidelines for Creating New Variables
# ============================================================================
#
# 1. REQUIRED FIELDS:
#    - id: Must be snake_case, unique within the spec file
#    - concept: The domain (economy, democracy, corruption, etc.)
#    - description: Clear, human-readable explanation
#    - source: Mapping of waves to question codes
#    - harmonize: At minimum, specify default method
#
# 2. OPTIONAL FIELDS:
#    - type: ordinal (default), nominal, continuous, etc.
#    - scale: Include min/max and optional labels
#    - qc: Quality control ranges and validation phrases
#    - tags: Metadata for organization
#
# 3. HARMONIZE BEST PRACTICES:
#    - Always specify a default method
#    - Only add exceptions for waves that differ
#    - Never repeat identical transformation rules
#
# 4. QC BEST PRACTICES:
#    - Use valid_range for all-wave validation
#    - Group waves in validate section by shared phrase
#    - Example: w1-w3 use "econom", w4-w6 use "economy"
#
# 5. SCALE DEFINITIONS:
#    - min/max are required if scale is included
#    - labels are optional but recommended
#    - Map numeric values to human-readable text
#
# 6. TAGS:
#    - core: Essential variables for analysis
#    - candidate_index:NAME: Variables that could form an index
#    - Keep consistent across all specifications
