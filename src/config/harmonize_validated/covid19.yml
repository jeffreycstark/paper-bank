# COVID-19 - Validated YAML (v2)
# Variables measuring COVID-19 impact, trust, and government response
# NOTE: These variables are ONLY available in Wave 6
# Validated 2025-01-11

missing_conventions:
  treat_as_na:
    codes: [-1, 0, 7, 8, 9, 97, 98, 99]
    description: "Standard missing codes"

variables:
  # ===========================================================================
  # GROUP 1: Personal/Family COVID Experience
  # ===========================================================================

  - id: covid_contracted
    concept: covid19
    description: "Have you or your family members previously contracted COVID-19?"
    type: nominal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q138

    scale:
      min: 1
      max: 2
      labels:
        1: "Yes"
        2: "No"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 2]
      validate:
        - waves: [w6]
          phrase: "contracted.*covid|covid.*virus"

  - id: covid_impact_illness
    concept: covid19
    description: "Did you or family suffer from serious illness or death due to COVID?"
    type: nominal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q139a

    scale:
      min: 1
      max: 2
      labels:
        1: "Yes"
        2: "No"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 2]
      validate:
        - waves: [w6]
          phrase: "illness|death"

  - id: covid_impact_job_loss
    concept: covid19
    description: "Did you or family suffer from loss of job due to COVID?"
    type: nominal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q139b

    scale:
      min: 1
      max: 2
      labels:
        1: "Yes"
        2: "No"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 2]
      validate:
        - waves: [w6]
          phrase: "loss of job"

  - id: covid_impact_income_loss
    concept: covid19
    description: "Did you or family suffer from loss of household income due to COVID?"
    type: nominal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q139c

    scale:
      min: 1
      max: 2
      labels:
        1: "Yes"
        2: "No"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 2]
      validate:
        - waves: [w6]
          phrase: "household income"

  - id: covid_impact_education
    concept: covid19
    description: "Did you or family suffer from disruption of kids' education due to COVID?"
    type: nominal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q139d

    scale:
      min: 1
      max: 2
      labels:
        1: "Yes"
        2: "No"

    harmonize:
      default:
        method: identity

    qc:
      valid_range: [1, 2]
      validate:
        - waves: [w6]
          phrase: "education"

  - id: covid_livelihood_impact
    concept: covid19
    description: "How serious is COVID's negative impact on your family's livelihood?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q140

    scale:
      min: 1
      max: 4
      labels:
        1: "Not serious at all"
        2: "Not very serious"
        3: "Somewhat serious"
        4: "Very serious"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w6]
          phrase: "livelihood|impact"

  # ===========================================================================
  # GROUP 2: Trust in Government COVID Response
  # ===========================================================================

  - id: covid_trust_govt_info
    concept: covid19
    description: "How much do you trust COVID-related information provided by the government?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q141

    scale:
      min: 1
      max: 4
      labels:
        1: "No trust at all"
        2: "Not much trust"
        3: "Quite a lot of trust"
        4: "A great deal of trust"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w6]
          phrase: "trust.*covid|covid.*information"

  - id: covid_govt_handling
    concept: covid19
    description: "How well or badly do you think the government handled the pandemic?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q142

    scale:
      min: 1
      max: 4
      labels:
        1: "Very badly"
        2: "Fairly badly"
        3: "Fairly well"
        4: "Very well"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w6]
          phrase: "handled.*pandemic|government.*pandemic"

  # ===========================================================================
  # GROUP 3: Economic Security / Future Concerns
  # ===========================================================================

  - id: worried_income_loss
    concept: covid19
    description: "How worried are you that your family might lose its major income source in next 12 months?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q161

    scale:
      min: 1
      max: 4
      labels:
        1: "Not worried at all"
        2: "Not very worried"
        3: "Somewhat worried"
        4: "Very worried"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w6]
          phrase: "worried|income"

  - id: income_loss_severity
    concept: covid19
    description: "If you lost your main income source, how serious would it be for your family?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q162
    # Note: Only asked of those with income; -1 = not applicable (no income)

    scale:
      min: 1
      max: 3
      labels:
        1: "Not serious at all"
        2: "Not very serious"
        3: "Somewhat/Very serious"

    harmonize:
      default:
        method: r_function
        fn: safe_3pt_none

    qc:
      valid_range: [1, 3]
      validate:
        - waves: [w6]
          phrase: "lose.*income|serious"

  - id: income_fairness
    concept: covid19
    description: "Considering all your effort, is the income your family receives fair?"
    type: ordinal

    source:
      w1: null
      w2: null
      w3: null
      w4: null
      w5: null
      w6: q163

    scale:
      min: 1
      max: 4
      labels:
        1: "Very unfair"
        2: "Somewhat unfair"
        3: "Somewhat fair"
        4: "Very fair"

    harmonize:
      default:
        method: r_function
        fn: safe_4pt_none

    qc:
      valid_range: [1, 4]
      validate:
        - waves: [w6]
          phrase: "fair"
